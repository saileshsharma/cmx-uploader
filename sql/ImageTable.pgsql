{"cells":[{"value":"CREATE TABLE IF NOT EXISTS outbox_event (\r\n  id               BIGSERIAL PRIMARY KEY,\r\n  aggregate_type   VARCHAR(80) NOT NULL,\r\n  aggregate_id     VARCHAR(80) NOT NULL,\r\n  type             VARCHAR(80) NOT NULL,          -- e.g. fnol.created\r\n  payload          JSONB NOT NULL,\r\n  headers          JSONB,\r\n  created_at       TIMESTAMPTZ NOT NULL DEFAULT now(),\r\n  published_at     TIMESTAMPTZ\r\n);\r\n\r\nCREATE INDEX IF NOT EXISTS idx_outbox_unpublished ON outbox_event (published_at) WHERE published_at IS NULL;\r\n","kind":"sql","language":"sql"},{"value":"DROP TABLE IF EXISTS public.outbox_event;","kind":"sql","language":"sql"},{"value":"ALTER TABLE image_asset ADD COLUMN IF NOT EXISTS description VARCHAR(256);","kind":"sql","language":"sql"},{"value":"CREATE TABLE image_asset (\r\n    id BIGSERIAL PRIMARY KEY,\r\n\r\n    -- FK to FNOL by reference number (string instead of numeric id)\r\n    fnol_reference_no TEXT NOT NULL,\r\n\r\n    kind VARCHAR(50) NOT NULL,            -- enum-like, mapped from ImageKind\r\n    filename TEXT NOT NULL,\r\n    ext TEXT,\r\n    mime_type TEXT,\r\n\r\n    size_bytes BIGINT NOT NULL,\r\n    width_px INT,\r\n    height_px INT,\r\n\r\n    checksum_sha256 CHAR(64) NOT NULL,\r\n\r\n    gcs_bucket TEXT NOT NULL,\r\n    gcs_object VARCHAR(512) NOT NULL,\r\n    storage_uri VARCHAR(1024) NOT NULL,\r\n\r\n    exif_json JSONB,                      -- stores EXIF metadata as JSON\r\n    uploaded_by TEXT,\r\n    uploaded_at TIMESTAMPTZ NOT NULL,\r\n\r\n    CONSTRAINT uq_image_asset UNIQUE (fnol_reference_no, checksum_sha256, kind)\r\n);\r\n\r\n-- Helpful indexes\r\nCREATE INDEX idx_image_asset_fnolref ON image_asset(fnol_reference_no);\r\nCREATE INDEX idx_image_asset_checksum ON image_asset(checksum_sha256);\r\nCREATE INDEX idx_image_asset_kind ON image_asset(kind);\r\n","kind":"sql","language":"sql"}],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[{"value":"CREATE TABLE IF NOT EXISTS outbox_event (\r\n  id               BIGSERIAL PRIMARY KEY,\r\n  aggregate_type   VARCHAR(80) NOT NULL,\r\n  aggregate_id     VARCHAR(80) NOT NULL,\r\n  type             VARCHAR(80) NOT NULL,          -- e.g. fnol.created\r\n  payload          JSONB NOT NULL,\r\n  headers          JSONB,\r\n  created_at       TIMESTAMPTZ NOT NULL DEFAULT now(),\r\n  published_at     TIMESTAMPTZ\r\n);\r\n\r\nCREATE INDEX IF NOT EXISTS idx_outbox_unpublished ON outbox_event (published_at) WHERE published_at IS NULL;\r\n","kind":"sql","language":"sql"},{"value":"DROP TABLE IF EXISTS public.outbox_event;","kind":"sql","language":"sql"},{"value":"ALTER TABLE image_asset ADD COLUMN IF NOT EXISTS description VARCHAR(256);","kind":"sql","language":"sql"},{"value":"CREATE TABLE image_asset (\r\n    id BIGSERIAL PRIMARY KEY,\r\n\r\n    -- FK to FNOL by reference number (string instead of numeric id)\r\n    fnol_reference_no TEXT NOT NULL,\r\n\r\n    kind VARCHAR(50) NOT NULL,            -- enum-like, mapped from ImageKind\r\n    filename TEXT NOT NULL,\r\n    ext TEXT,\r\n    mime_type TEXT,\r\n\r\n    size_bytes BIGINT NOT NULL,\r\n    width_px INT,\r\n    height_px INT,\r\n\r\n    checksum_sha256 CHAR(64) NOT NULL,\r\n\r\n    gcs_bucket TEXT NOT NULL,\r\n    gcs_object VARCHAR(512) NOT NULL,\r\n    storage_uri VARCHAR(1024) NOT NULL,\r\n\r\n    exif_json JSONB,                      -- stores EXIF metadata as JSON\r\n    uploaded_by TEXT,\r\n    uploaded_at TIMESTAMPTZ NOT NULL,\r\n\r\n    CONSTRAINT uq_image_asset UNIQUE (fnol_reference_no, checksum_sha256, kind)\r\n);\r\n\r\n-- Helpful indexes\r\nCREATE INDEX idx_image_asset_fnolref ON image_asset(fnol_reference_no);\r\nCREATE INDEX idx_image_asset_checksum ON image_asset(checksum_sha256);\r\nCREATE INDEX idx_image_asset_kind ON image_asset(kind);\r\n","kind":"sql","language":"sql"}],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[{"value":"SELECT fnol_reference_no, description\r\nFROM public.image_asset\r\nLIMIT 100;","kind":"sql","language":"sql"},{"value":"ALTER TABLE image_asset ADD COLUMN IF NOT EXISTS description VARCHAR(256);","kind":"sql","language":"sql"},{"value":"CREATE TABLE image_asset (\r\n    id BIGSERIAL PRIMARY KEY,\r\n\r\n    -- FK to FNOL by reference number (string instead of numeric id)\r\n    fnol_reference_no TEXT NOT NULL,\r\n\r\n    kind VARCHAR(50) NOT NULL,            -- enum-like, mapped from ImageKind\r\n    filename TEXT NOT NULL,\r\n    ext TEXT,\r\n    mime_type TEXT,\r\n\r\n    size_bytes BIGINT NOT NULL,\r\n    width_px INT,\r\n    height_px INT,\r\n\r\n    checksum_sha256 CHAR(64) NOT NULL,\r\n\r\n    gcs_bucket TEXT NOT NULL,\r\n    gcs_object VARCHAR(512) NOT NULL,\r\n    storage_uri VARCHAR(1024) NOT NULL,\r\n\r\n    exif_json JSONB,                      -- stores EXIF metadata as JSON\r\n    uploaded_by TEXT,\r\n    uploaded_at TIMESTAMPTZ NOT NULL,\r\n\r\n    CONSTRAINT uq_image_asset UNIQUE (fnol_reference_no, checksum_sha256, kind)\r\n);\r\n\r\n-- Helpful indexes\r\nCREATE INDEX idx_image_asset_fnolref ON image_asset(fnol_reference_no);\r\nCREATE INDEX idx_image_asset_checksum ON image_asset(checksum_sha256);\r\nCREATE INDEX idx_image_asset_kind ON image_asset(kind);\r\n","kind":"sql","language":"sql"}],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[{"value":"SELECT *\r\nFROM public.image_asset\r\nLIMIT 100;","kind":"sql","language":"sql"},{"value":"ALTER TABLE image_asset ADD COLUMN IF NOT EXISTS description VARCHAR(256);","kind":"sql","language":"sql"},{"value":"CREATE TABLE image_asset (\r\n    id BIGSERIAL PRIMARY KEY,\r\n\r\n    -- FK to FNOL by reference number (string instead of numeric id)\r\n    fnol_reference_no TEXT NOT NULL,\r\n\r\n    kind VARCHAR(50) NOT NULL,            -- enum-like, mapped from ImageKind\r\n    filename TEXT NOT NULL,\r\n    ext TEXT,\r\n    mime_type TEXT,\r\n\r\n    size_bytes BIGINT NOT NULL,\r\n    width_px INT,\r\n    height_px INT,\r\n\r\n    checksum_sha256 CHAR(64) NOT NULL,\r\n\r\n    gcs_bucket TEXT NOT NULL,\r\n    gcs_object VARCHAR(512) NOT NULL,\r\n    storage_uri VARCHAR(1024) NOT NULL,\r\n\r\n    exif_json JSONB,                      -- stores EXIF metadata as JSON\r\n    uploaded_by TEXT,\r\n    uploaded_at TIMESTAMPTZ NOT NULL,\r\n\r\n    CONSTRAINT uq_image_asset UNIQUE (fnol_reference_no, checksum_sha256, kind)\r\n);\r\n\r\n-- Helpful indexes\r\nCREATE INDEX idx_image_asset_fnolref ON image_asset(fnol_reference_no);\r\nCREATE INDEX idx_image_asset_checksum ON image_asset(checksum_sha256);\r\nCREATE INDEX idx_image_asset_kind ON image_asset(kind);\r\n","kind":"sql","language":"sql"}],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[{"value":"SELECT *\r\nFROM public.image_asset\r\nLIMIT 100;","kind":"sql","language":"sql"},{"value":"CREATE TABLE image_asset (\r\n    id BIGSERIAL PRIMARY KEY,\r\n\r\n    -- FK to FNOL by reference number (string instead of numeric id)\r\n    fnol_reference_no TEXT NOT NULL,\r\n\r\n    kind VARCHAR(50) NOT NULL,            -- enum-like, mapped from ImageKind\r\n    filename TEXT NOT NULL,\r\n    ext TEXT,\r\n    mime_type TEXT,\r\n\r\n    size_bytes BIGINT NOT NULL,\r\n    width_px INT,\r\n    height_px INT,\r\n\r\n    checksum_sha256 CHAR(64) NOT NULL,\r\n\r\n    gcs_bucket TEXT NOT NULL,\r\n    gcs_object VARCHAR(512) NOT NULL,\r\n    storage_uri VARCHAR(1024) NOT NULL,\r\n\r\n    exif_json JSONB,                      -- stores EXIF metadata as JSON\r\n    uploaded_by TEXT,\r\n    uploaded_at TIMESTAMPTZ NOT NULL,\r\n\r\n    CONSTRAINT uq_image_asset UNIQUE (fnol_reference_no, checksum_sha256, kind)\r\n);\r\n\r\n-- Helpful indexes\r\nCREATE INDEX idx_image_asset_fnolref ON image_asset(fnol_reference_no);\r\nCREATE INDEX idx_image_asset_checksum ON image_asset(checksum_sha256);\r\nCREATE INDEX idx_image_asset_kind ON image_asset(kind);\r\n","kind":"sql","language":"sql"}],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[{"value":"DROP TABLE IF EXISTS public.flyway_schema_history;\r\nDROP TABLE IF EXISTS public.image_asset;","kind":"sql","language":"sql"},{"value":"CREATE TABLE image_asset (\r\n    id BIGSERIAL PRIMARY KEY,\r\n\r\n    -- FK to FNOL by reference number (string instead of numeric id)\r\n    fnol_reference_no TEXT NOT NULL,\r\n\r\n    kind VARCHAR(50) NOT NULL,            -- enum-like, mapped from ImageKind\r\n    filename TEXT NOT NULL,\r\n    ext TEXT,\r\n    mime_type TEXT,\r\n\r\n    size_bytes BIGINT NOT NULL,\r\n    width_px INT,\r\n    height_px INT,\r\n\r\n    checksum_sha256 CHAR(64) NOT NULL,\r\n\r\n    gcs_bucket TEXT NOT NULL,\r\n    gcs_object VARCHAR(512) NOT NULL,\r\n    storage_uri VARCHAR(1024) NOT NULL,\r\n\r\n    exif_json JSONB,                      -- stores EXIF metadata as JSON\r\n    uploaded_by TEXT,\r\n    uploaded_at TIMESTAMPTZ NOT NULL,\r\n\r\n    CONSTRAINT uq_image_asset UNIQUE (fnol_reference_no, checksum_sha256, kind)\r\n);\r\n\r\n-- Helpful indexes\r\nCREATE INDEX idx_image_asset_fnolref ON image_asset(fnol_reference_no);\r\nCREATE INDEX idx_image_asset_checksum ON image_asset(checksum_sha256);\r\nCREATE INDEX idx_image_asset_kind ON image_asset(kind);\r\n","kind":"sql","language":"sql"}],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[{"value":"CREATE TABLE image_asset (\r\n    id BIGSERIAL PRIMARY KEY,\r\n\r\n    -- FK to FNOL by reference number (string instead of numeric id)\r\n    fnol_reference_no TEXT NOT NULL,\r\n\r\n    kind VARCHAR(50) NOT NULL,            -- enum-like, mapped from ImageKind\r\n    filename TEXT NOT NULL,\r\n    ext TEXT,\r\n    mime_type TEXT,\r\n\r\n    size_bytes BIGINT NOT NULL,\r\n    width_px INT,\r\n    height_px INT,\r\n\r\n    checksum_sha256 CHAR(64) NOT NULL,\r\n\r\n    gcs_bucket TEXT NOT NULL,\r\n    gcs_object VARCHAR(512) NOT NULL,\r\n    storage_uri VARCHAR(1024) NOT NULL,\r\n\r\n    exif_json JSONB,                      -- stores EXIF metadata as JSON\r\n    uploaded_by TEXT,\r\n    uploaded_at TIMESTAMPTZ NOT NULL,\r\n\r\n    CONSTRAINT uq_image_asset UNIQUE (fnol_reference_no, checksum_sha256, kind)\r\n);\r\n\r\n-- Helpful indexes\r\nCREATE INDEX idx_image_asset_fnolref ON image_asset(fnol_reference_no);\r\nCREATE INDEX idx_image_asset_checksum ON image_asset(checksum_sha256);\r\nCREATE INDEX idx_image_asset_kind ON image_asset(kind);","kind":"sql","language":"sql"}],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[{"value":"\r\n\r\n","kind":"sql","language":"sql"}],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[{"value":"CREATE TABLE image_asset (\r\n    id BIGSERIAL PRIMARY KEY,\r\n\r\n    -- FK to FNOL by reference number (string instead of numeric id)\r\n    fnol_reference_no TEXT NOT NULL,\r\n\r\n    kind VARCHAR(50) NOT NULL,            -- enum-like, mapped from ImageKind\r\n    filename TEXT NOT NULL,\r\n    ext TEXT,\r\n    mime_type TEXT,\r\n\r\n    size_bytes BIGINT NOT NULL,\r\n    width_px INT,\r\n    height_px INT,\r\n\r\n    checksum_sha256 CHAR(64) NOT NULL,\r\n\r\n    gcs_bucket TEXT NOT NULL,\r\n    gcs_object VARCHAR(512) NOT NULL,\r\n    storage_uri VARCHAR(1024) NOT NULL,\r\n\r\n    exif_json JSONB,                      -- stores EXIF metadata as JSON\r\n    uploaded_by TEXT,\r\n    uploaded_at TIMESTAMPTZ NOT NULL,\r\n\r\n    CONSTRAINT uq_image_asset UNIQUE (fnol_reference_no, checksum_sha256, kind)\r\n);\r\n\r\n-- Helpful indexes\r\nCREATE INDEX idx_image_asset_fnolref ON image_asset(fnol_reference_no);\r\nCREATE INDEX idx_image_asset_checksum ON image_asset(checksum_sha256);\r\nCREATE INDEX idx_image_asset_kind ON image_asset(kind);\r\n","kind":"sql","language":"sql"},{"value":"-- View table data\r\nSELECT *\r\nFROM public.image_asset\r\nLIMIT 100;\r\n","kind":"sql","language":"sql"}],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[{"value":"DROP TABLE IF EXISTS public.image_asset;","kind":"sql","language":"sql"},{"value":"-- View table data\r\nSELECT *\r\nFROM public.image_asset\r\nLIMIT 100;\r\n","kind":"sql","language":"sql"}],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[{"value":"-- View table data\nSELECT *\nFROM public.image_asset\nLIMIT 100;","kind":"sql","language":"sql"}],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[{"value":"# View Table Data: public.image_asset\n\nModify the query below to filter or transform the data as needed.","kind":"markdown","language":"markdown"},{"value":"-- View table data\nSELECT *\nFROM public.image_asset\nLIMIT 100;","kind":"sql","language":"sql"}],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","custom":{"cells":[],"metadata":{"connectionId":"1755479140424","databaseName":"cmx_upload","host":"localhost","port":5432,"username":"producer_user","password":"PRODUCER_USER","enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}}}}